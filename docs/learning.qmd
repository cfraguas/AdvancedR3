---
title: "Draft Quarto document"
author: "Conchita Fraguas"
format: html
---

## Testing formatting styles

```{r setup}
library(tidyverse)
library(targets)
tar_config_set(store = here::here("_targets"))
source(here::here("R/functions.R"))
lipidomics <- tar_read(lipidomics)
```

## Making a table

```{r}
lipidomics |>
  group_by(metabolite) |>
  summarise(across(value, list(mean = mean, sd = sd))) |>
  mutate(across(where(is.numeric), \(x) round(x, digits = 2))) |>
  mutate(MeanSD = glue::glue("{value_mean} ({value_sd})")) |>
  select(Metabolite = metabolite, "Mean SD" = "MeanSD")
```

```{r}
#' create_table_descriptive_stats
#'
#' @param data 
#'
#' @returns summarised mean + SD rounded metabolite data values

create_table_descriptive_stats <- 
  function(data) {
    data |>  
  dplyr::group_by(metabolite) |> 
  dplyr::summarise(dplyr::across(value, list(mean = mean, sd = sd))) |>
  dplyr::mutate(dplyr::across(tidyselect::where(is.numeric), \(x) round(x, digits = 2))) |>
  dplyr::mutate(MeanSD = glue::glue("{value_mean} ({value_sd})")) |>
  dplyr::select(Metabolite = metabolite, "Mean SD" = "MeanSD")
  }
```

```{r}
create_table_descriptive_stats(lipidomics)
```
